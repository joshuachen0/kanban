from kanban import *
import sys
import StringIO

# Testing suite for kanban class

#Need to test add, remove, and move functions, including behavior of errors.
#Need to try and catch errors and display the proper functions

# Generate test file
file_name = 'tester'
with open(file_name, 'w') as f:
    f.write('to do|4||\n')
    f.write('on hold|3||\n')
    f.write('doing|2||\n')
    f.write('done|9||\n')

# Instantiate instance of kanban class with test file
kb = kanban('tester')
assert kb.name == 'tester'
assert kb.num_of_areas == 4
assert kb.area_names == ['to do', 'on hold', 'doing', 'done']
assert kb.sizes == [4, 3, 2, 9]
assert kb.tasks == [[], [], [], []]
assert kb.display == '+-------+---------+-------+------+\n| to do | on hold | doing | done |\n+-------+---------+-------+------+\n+-------+---------+-------+------+\n|       |         |       |      |\n+-------+---------+-------+------+\n|       |         |       |      |\n+-------+---------+-------+------+\n|       |         |~~~~~~~|      |\n+-------+---------+-------+------+\n|       |~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n'

# Add tasks to kanban board
kb.add_task('play games')
kb.generate_display()
assert kb.tasks == [['1 play games'], [], [], []]
assert kb.display == '+--------------+---------+-------+------+\n| to do        | on hold | doing | done |\n+--------------+---------+-------+------+\n+--------------+---------+-------+------+\n| 1 play games |         |       |      |\n+--------------+---------+-------+------+\n|              |         |       |      |\n+--------------+---------+-------+------+\n|              |         |~~~~~~~|      |\n+--------------+---------+-------+------+\n|              |~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n'

temp = sys.stdin
f = StringIO.StringIO('y')
sys.stdin = f
kb.rem_task(1)
sys.stdin = temp
f.close()
kb.generate_display()
assert kb.tasks == [[], [], [], []]
assert kb.display == '+-------+---------+-------+------+\n| to do | on hold | doing | done |\n+-------+---------+-------+------+\n+-------+---------+-------+------+\n|       |         |       |      |\n+-------+---------+-------+------+\n|       |         |       |      |\n+-------+---------+-------+------+\n|       |         |~~~~~~~|      |\n+-------+---------+-------+------+\n|       |~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n|~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+-------+---------+-------+------+\n'

try:
    while 1:
        kb.add_task('play games')
except Exception as e:
    pass

kb.generate_display()
assert type(e) == AreaOutOfSpaceError
assert e.area == 'to do'
assert kb.tasks == [['1 play games', '2 play games', '3 play games', '4 play games'], [], [], []]
assert kb.display == '+--------------+---------+-------+------+\n| to do        | on hold | doing | done |\n+--------------+---------+-------+------+\n+--------------+---------+-------+------+\n| 1 play games |         |       |      |\n+--------------+---------+-------+------+\n| 2 play games |         |       |      |\n+--------------+---------+-------+------+\n| 3 play games |         |~~~~~~~|      |\n+--------------+---------+-------+------+\n| 4 play games |~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n|~~~~~~~~~~~~~~|~~~~~~~~~|~~~~~~~|      |\n+--------------+---------+-------+------+\n'
